# 六、在电子表格和数据库之间选择

小型企业经常使用电子表格，而数据库可能更合适。这通常是由于对电子表格的广泛熟悉以及开始有效使用它们所需的较短的学习曲线。一次又一次，内部缺乏关于数据库及其潜在好处的知识。

本章旨在通过解释电子表格的局限性，它们如何导致困难，以及数据库如何克服这些问题，来帮助您决定数据库是否会对您的小型企业有益。它旨在让您注意到这些问题，并警告您随着数据量和复杂性的增加，这些问题可能会变得更加严重。有些情况下，电子表格对于数据处理来说绰绰有余，我无意误导您。相反，我想警告你使用电子表格作为数据库的陷阱，这样你就不会陷入一场你本可以避免的危机。

## 概观

这本书假设你熟悉电子表格。正如您在前面章节中看到的，电子表格和数据库有许多相似之处。鉴于此，您可能想知道为什么您应该考虑使用数据库。在电子表格和数据库之间进行选择，并不是提供一系列标准让您能够快速做出决定。这样的决定可能取决于多种因素。

您不必立即决定是否迁移到数据库。如果在阅读完本章之后，您决定将数据操作转移到数据库中，那么您可以从采取一些小步骤开始，为以后的转换准备数据。按照本章中的建议，您可以学习如何在电子表格中有效地组织数据，这将在您获取大量数据时节省您的工作。

将数据转移到数据库并不意味着你不能使用电子表格。大多数数据库允许数据在数据库和电子表格之间方便地来回移动。所以，如果你习惯使用电子表格格式，你就不必把它留在身后。事实上，许多企业选择同时使用数据库和电子表格，以便利用两者的优势。

你的业务目标可能会帮助你决定是电子表格还是数据库更合适。如果您的目标相当简单，并且将反映在数据的一维增长中，例如，唯一变化的数据项是客户数量，那么您的数据的复杂性不太可能发生很大变化。然而，如果目标是引入新产品，开始新的宣传活动，并遵循新的指标，您的数据可能会变得更加复杂。电子表格处理数据的效率可能会降低，转移到数据库可能更合适。

就软件而言，数据库不是电子表格的唯一替代品。例如，在[第 3 章](03.html)中，为法律事务所案例研究展示了许多基于网络的软件解决方案，包括任务管理、案例状态和时间跟踪。通过展示数据库的强大功能，本章使您能够将数据库的优势与电子表格之外的软件进行比较。然而，重点是电子表格。

随着电子表格包的发展，在电子表格包中运行数据库类型的结构已经成为可能。比如 Excel 2013 可以处理很多数据库特征，比如链接表。因此，选择不一定是在数据库包和电子表格包之间，而是在数据库的概念和电子表格的概念之间。

下面几节介绍了在决定使用数据库而不是电子表格时需要考虑的问题。数据复杂性得到了最多的关注，因为它是最相关的问题，并且经受住了时间的考验，不管技术如何改进。

## 数据复杂性

随着数据变得越来越复杂，将数据从电子表格转移到数据库可能是个好主意的迹象开始出现。这并不一定关系到数据的实际数量，而是数据中不同“主题”或“主题”的数量。例如，在[第 1 章](01.html)中介绍的 Cards for Everyone Inc .的数据库中包含四个主题——客户、发票、产品和供应商。

### 一份简单的清单

如前所述，对于一个简单的、孤立的列表，电子表格可能就足够了。一个例子是客户列表。即使列表变得很长——多达几千行——电子表格也足够了。例如，从 MS Excel 2007 开始，MS Excel 电子表格可以处理超过一百万行。

但是，如果您在多个列中有数据，并且这些列之间有关系，那么电子表格会很快变得复杂和麻烦，如下一节所示。

### 重复数据

随着电子表格中包含的列数的增加，重复数据或数据冗余的可能性变得更大。数据冗余的一个非常简单的例子出现在 Smart 独轮车公司在第 2 章中使用的电子表格中，其中邮政编码在表 [2-3](02.html#Tab3) 和 [2-4](02.html#Tab4) 中重复。为了说明这个问题，这些表在这里再次显示为表 [6-1](#Tab1) 和 [6-2](#Tab2) 。

表 6-2。

Basic Invoices Spreadsheet from Smart Wheelbarrows Inc.

<colgroup><col> <col> <col> <col></colgroup> 
| 名字 | 邮政区码 | 日期 | 金额(美元) |
| --- | --- | --- | --- |
| 光明花店 | 纽约州 11375 | 。。。 | 。。。 |
| 希拉里·史密斯 | 马 02108 | 。。。 | 。。。 |
| 布利斯花园中心 | RI 02886 | 。。。 | 。。。 |

表 6-1。

Basic Customer Spreadsheet from Smart Wheelbarrows Inc.

<colgroup><col> <col> <col> <col> <col></colgroup> 
| 名字 | 邮政区码 | 电话 | 电子邮件 | 种类 |
| --- | --- | --- | --- | --- |
| 光明花店 | 纽约州 11375 | 。。。 | 。。。 | 商业 |
| 希拉里·史密斯 | 马 02108 | 。。。 | 。。。 | 商业 |
| 布利斯花园中心 | RI 02886 | 。。。 | 。。。 | 消费者 |

显然，如果数据存储在多个地方，任何更改都需要多次进行。例如，如果希拉里·史密斯的邮政编码发生变化，那么需要对表 [6-1](#Tab1) 和 [6-2](#Tab2) 进行相同的编辑。因此，与将数据存储在一个位置的情况相比，编辑可能不太可靠。此外，冗余数据还会占用不必要的磁盘空间，尽管这并不是当前的优先考虑事项。

在本例中，通过从客户电子表格或发票电子表格中删除邮政编码列，可以很容易地解决邮政编码重复的问题。然而，电子表格上的许多数据冗余问题无法以如此直接的方式解决。假设来自 Cards for Everyone Inc .的客户和发票数据存储在一个电子表格中，如表 [6-3](#Tab3) 中前三张发票所示。这种布局的原因可能是为了保持客户数据和发票数据紧密关联，并且在查看电子表格时可见。

表 6-3。

Combined Customer and Invoice Spreadsheet

<colgroup><col> <col> <col> <col> <col></colgroup> 
| 用户姓名 | 邮政区码 | 电子邮件 | 日期 | 金额(美元) |
| --- | --- | --- | --- | --- |
| 加西亚 | 米 48823 | Lgarcia@。。。 | 11/4/14 | Seventeen |
| 约翰·威廉姆斯 | 或者 97062 | Jwilliams@。。。 | 11/4/14 | Two point five |
| 史蒂夫·琼斯 | FL 33901 | Sjones@。。。 | 11/4/14 | Fourteen |

当约翰·威廉姆斯下第二个订单时，有两种主要的方法可以将这些数据插入到表格 [6-3](#Tab3) 的电子表格中。

首先，可以为约翰·威廉姆斯的第二个订单插入一个新行，如表格 [6-4](#Tab4) 中的电子表格所示。

表 6-4。

Combined Customer and Invoices Spreadsheet with Extra Row for John Williams

<colgroup><col> <col> <col> <col> <col></colgroup> 
| 用户姓名 | 邮政区码 | 电子邮件 | 日期 | 金额(美元) |
| --- | --- | --- | --- | --- |
| 加西亚 | 米 48823 | Lgarcia@。。。 | 11/4/14 | Seventeen |
| 约翰·威廉姆斯 | 或者 97062 | Jwilliams@小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号-什么 | 11/4/14 | Two point five |
| 史蒂夫·琼斯 | FL 33901 | Sjones@.. | 11/4/14 | Fourteen |
| 约翰·威廉姆斯 | 或者 97062 | Jwilliams@小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号-什么 | 12/14/14 | Five |

但是，这一行创建了关于约翰·威廉姆斯邮政编码和电子邮件地址的冗余数据。虽然这种性质的重复不会造成太大的问题，如果你有少量的订单，几个订单后，它可能会成为一个问题。这是因为对约翰·威廉姆斯邮政编码和/或电子邮件地址的任何更改都需要在几个地方进行，从而浪费时间并有出错的风险。如果其他几个客户也下了多份订单，问题会更加严重。

其次，可以在约翰·威廉姆斯的记录旁边放置新的列来捕获关于他的第二个订单的数据，如表格 [6-5](#Tab5) 中的电子表格所示。这将避免对关于邮政编码和电子邮件地址的冗余数据的潜在需求。然而，这种方法很快就会变得非常混乱。比方说，如果约翰·威廉姆斯在一年的时间里总共下了 20 个订单，那么目前的电子表格将有 40 个额外的日期和金额列。搜索特定日期的特定订单需要扫描许多列，或者在自动搜索工具中输入公式。

表 6-5。

Combined Customer and Invoices Spreadsheet with Extra Columns for John Williams

<colgroup><col> <col> <col> <col> <col> <col> <col></colgroup> 
| 用户姓名 | 邮政区码 | 电子邮件 | 日期 | 金额(美元) | dota2 | 金额 2(美元) |
| --- | --- | --- | --- | --- | --- | --- |
| 加西亚 | 米 48823 | Lgarcia@。。。 | 11/4/14 | Seventeen |   |   |
| 约翰·威廉姆斯 | 或者 97062 | Jwilliams@小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号:jwilliams @小行星编号-什么 | 11/4/14 | Two point five | 12/14/14 | Five |
| 史蒂夫·琼斯 | FL 33901 | Sjones@.. | 11/4/14 | Fourteen |   |   |

出现这些问题是因为在同一个电子表格中有与多个主题相关的数据。该电子表格是关于发票的，但它也包含关于客户的数据。

数据库设计的目的是组织数据以使冗余最小化:更多细节在第 7 章中给出。为每个主题创建一个单独的表，目的是数据只占用它需要的空间。这样，就有可能找到一张发票，检查相应的客户唯一标识符，然后在 Customers 表中找到客户的详细信息:数据库会自动创建这些链接，而不需要用户参与详细信息。同样，可以通过 Customers 表中的客户唯一标识符来标识客户，并且可以从 Invoices 表中提取具有该客户唯一标识符的所有发票记录。虽然有两个表，但是每个客户和每张发票在系统中只有一个条目。这导致更有效的更新、数据存储和数据检索。

在 Cards for Everyone Inc .的数据库中，有关发票和客户的数据被拆分并链接到一个数据库中，这消除了前面讨论过的冗余问题。表格 [6-6](#Tab6) 和 [6-7](#Tab7) 展示了如何将约翰·威廉姆斯的订单添加到 Cards for Everyone Inc .数据库中，没有冗余数据，也没有额外的列。每个表格中的所有内容都与一个主题相关。

表 6-7。

Basic Invoice Table

<colgroup><col> <col> <col> <col></colgroup> 
| 发票号 | 客户 ID | 日期 | 金额(美元) |
| --- | --- | --- | --- |
| One thousand and one | one | 11/4/14 | Seventeen |
| One thousand and two | Two | 11/4/14 | Two point five |
| One thousand and three | three | 11/4/14 | Fourteen |
| One thousand and four | Two | 12/14/14 | Five |

表 6-6。

Basic Customer Database Table

<colgroup><col> <col> <col> <col></colgroup> 
| 客户 ID | 名字 | 邮政区码 | 电子邮件 |
| --- | --- | --- | --- |
| one | 加西亚 | 米 48823 | 天主教霍特 mail.com 教区 |
| Two | 约翰·威廉姆斯 | 或者 97062 | Jwilliams @gmail.com |
| three | 史蒂夫·琼斯 | FL 33901 | Tiones @aol.com |

### 维护电子表格之间的关系

即使删除了电子表格中的冗余，仍然存在维护它们之间准确关系的问题。这个问题在数据库中通过使用数据组织中的许多逻辑步骤来解决，这些逻辑步骤使得数据能够在多个表中自动更新和删除。这在第 7 章中有详细解释。在电子表格中，通常需要手工操作。

例如，假设 Cards for Everyone Inc .正在为产品和供应商制作单独的电子表格，见表 [6-8](#Tab8) 和 [6-9](#Tab9) 。

表 6-9。

Basic Supplier Spreadsheet for Cards for Everyone Inc.

<colgroup><col> <col> <col> <col></colgroup> 
| 供应商名称 | 邮政区码 | 电话 | 电子邮件 |
| --- | --- | --- | --- |
| 特殊场合 | IA 52241 | 319-xxx-xxxx | 管理员@特殊 occasions.com |
| 旧的最爱 | CA 92591 | 503-xxx-xxxx | 旧 favorites.com 办公室 |
| 手工卡片 | FL 33351 | 954-xxx-xxxx | 查询@手 madecards.com |

表 6-8。

Basic Product Spreadsheet for Cards for Everyone Inc.

<colgroup><col> <col> <col> <col> <col></colgroup> 
| 产品名称 | 供应商名称 | 种类 | 价格(美元) | 可用数量 |
| --- | --- | --- | --- | --- |
| 猫 | 特殊场合 | 生日 | Two | five |
| 玫瑰 | 旧的最爱 | 谢谢你 | Three | eight |
| 船 | 旧的最爱 | 生日 | Two point five | Ten |
| 心 | 手工卡片 | 情人 | Four point five | nine |
| 兔子 | 手工卡片 | 新生婴儿 | Five | Eleven |

如果其中一个供应商停止交易，您可能希望将他们从供应商电子表格中删除。你可能还想移除他们提供的任何卡片，这样你就不会浪费时间去订购它们，或者更糟的是，向客户做广告。例如，如果“手工制作的卡片”停止交易，您需要从表 [6-8](#Tab8) 中移除“红心”和“兔子”。

从包含连接数据的电子表格中手动删除条目会变得非常耗时，并会导致错误。而且，如果 Cards for Everyone Inc .使用该供应商的其他电子表格，这些条目也必须从这些电子表格中删除。

如果一组电子表格仅由一个人维护，那么这种修改可能会可靠地执行，即使它们很费力。但是，如果不止一个人负责更新电子表格，或者如果人员发生变化，那么数据不匹配的可能性就会高得多。

在数据库中，可以指定关于表更新的某些规则。有了这样的规则，一个表中的更新不能在相关表中没有更新的情况下发生；如果在其他表中没有相应的删除，就不能从一个表中删除数据。这样的规范有助于避免数据不一致。例如，Cards for Everyone Inc .不想错过向新客户发送发票，因为发票已被添加到发票表中，但没有相应的客户被添加到客户表中。如果他们使用数据库，这是可以避免的。

### 数据复杂性概述

如果您发现您的企业花费大量时间将相同的数据输入到多个电子表格中，那么您已经为数据库做好了准备。数据库减少了必要的数据输入量，从而减少了潜在的打字错误。

数据库使得在一个地方存储数据和在多个地方引用数据变得容易。例如，客户数据可以存储在包含姓名、地址、电话号码、电子邮件等的表中。然后可以在其他地方引用它，例如在查询、窗体和报表中。

Note

第 1 章中介绍了查询、表格和报告。查询在[第 12 章](12.html)中详细讨论，表格在[第 10 章](10.html)中讨论，报告在[第 14 章](14.html)中讨论。本书末尾的附录描述了如何建立一个简单的查询、表单和报表。

如果客户的数据发生变化，在使用数据库时，您只需在一个地方更改该信息。新数据将在引用它的所有查询、窗体和报表中自动可见。

作为最后的评论，如果对你的电子表格的修改不经常发生，这些论点就失去了它们的分量。这个决定是一个只有你才能做出的平衡。

## 数据将被使用的时间段

下一个决策点涉及您将花费在数据上的时间。对于偶尔的简短数据分析，电子表格已经足够了——对于一个简短的项目来说，学习数据库技术是多余的。使用电子表格不需要很长时间就能变得高效，而且非常灵活。现在很少有人不会使用基本的电子表格。

但是，如果您需要随着时间的推移分析相同的数据，并且这些数据很复杂，那么数据库可能会有所帮助。一旦你需要搜索数据，内置的电子表格功能可能是不够的。你需要编程技能来实现搜索，很少有电子表格用户具备这些技能。

## 用户数量

另一个重要的决策点涉及到在任何给定时间需要访问数据的人数。如果一次只有一个人访问数据，那么继续使用电子表格是可能的，尽管在某些情况下很有挑战性。有必要清楚地说明电子表格系统是如何工作的，以防将来维护电子表格的责任被转移。

如果有很多人使用同一个电子表格，避免错误会很困难。在过去的几年中，共享文档的选择要么是通过电子邮件附件，要么是将副本放在办公室的共享驱动器上。跟踪几个用户的版本和编辑可能是困难和耗时的。如今，电子表格可以存在于云中，由几个用户使用，例如，通过使用 Excel Web 应用程序。云在[第 18 章](18.html)中详细讨论。

无论用什么方法存储电子表格，出错的风险都很高，尤其是那些没有经验的人。例如，对电子表格中的单个列进行排序而不扩展到其他列会破坏电子表格，并导致返回到以前的版本和浪费工作。这是那些不经常使用电子表格的人经常犯的错误。

一般来说，最好保持电子表格的用户数量较少，并对他们进行全面的培训。有了数据库，用户可以同时访问数据，并且更容易设计查看数据的方法，而不会导致数据本身的更改，例如，通过表单。

Note

第 1 章中介绍了表格。附录描述了如何创建简单的表单。

仅仅让几个用户使用同一个电子表格不足以证明单独使用一个数据库是正确的。例如，让几个用户修改包含简单客户列表的电子表格是可以接受的，因为这并不难管理。但是让几个用户访问一个更复杂的电子表格会导致严重的复杂化。在这种情况下，数据库可能更有效。

## 对报告的要求

如果您需要定期生成报告，很可能需要一个数据库。使用电子表格时，电子表格和报表不是独立的。当您构建电子表格时，数据被格式化和排列，以便得到所需的报告。对于数据库，数据和报告功能是不相连的，这使您能够使用相同的数据生成多个报告，从而提供了灵活性和效率。

例如，您可能希望生成以下三个报告:

*   按季度的总销售额
*   按地区划分的年销售额
*   按产品类型划分的月销售额

这些报告都涉及销售数据的使用。数据库允许您使用查询从一个数据源生成所有三个报表，而不是维护三个包含重复数据的电子表格，无需复制和粘贴。

Note

第 1 章中介绍了查询。附录描述了如何设置一个简单的查询。

这种方法节省了时间，并且不容易出错，因为报告是直接从数据库生成的，而数据库是对数据进行更改的唯一地方。这又回到了前面讨论的冗余数据的问题:如果您有相同数据的几个副本，除非您高度警惕，否则您无法保证它们在任何一个时间都被更新。

## 两全其美

正如本章开始时提到的，选择将数据转移到数据库并不意味着您不再有使用电子表格的选择。在许多情况下，两者的结合是最好的方法。您可以将数据存储在数据库中，从而运行高级报告和查询。反过来，这些报告和查询可以移动到电子表格中进行更深入的分析。电子表格的优势在于它们能够使用高级公式进行单独的复杂计算。

## 摘要

决定使用电子表格还是数据库是一个不断变化的过程。技术不会停滞不前。例如，如您所见，数据量不再像过去那样是一个重要的考虑因素。随着云的使用，多用户访问的功能对于电子表格来说不再是问题。然而，电子表格不能有效地处理多主题数据，导致需要在几个地方存储数据。这是低效的，并且可能导致键入和不匹配错误。数据库非常适合将数据集中在一起、分离主题、将表链接在一起、实现高效的数据存储以及更新和检索数据。您还可以从数据库中快速准确地创建报告。

如果您的数据包含许多主题，并且这些主题会随着时间的推移而存储，并且会定期更改，那么采用数据库是有意义的。

如果您已经阅读完本章，并且已经决定要迁移到一个数据库，请放心，您不需要现在就迁移，也不需要一下子就迁移。你可以采取小步骤，这将有助于你以后做出更有效的行动。例如，您可以考虑数据中包含的主题以及您拥有的冗余数据量。你可以考虑将一些电子表格分成单独的主题。这些步骤将使你在进行转换时减少工作量。不管怎样，正如第 15 章所示，期望所有关于数据库设计的决定都提前做出是不现实的。随着业务的发展，会发生一些变化。数据库很少是静态的。